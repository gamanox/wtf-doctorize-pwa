<template>
  <div class="page home" id="home">

    <div class="navbar" id="nav1">
      <div class="navbar-inner sliding">
        <div class="left">
          <div class="fab fab-left-middle color-white profile panel-open">
            <i class="icon material-icons">photo</i>
          </div>
        </div>
        <div class="right">
          <div class="fab fab-right-middle color-white search">
            <a href="#">
              <i class="icon material-icons">search</i>
            </a>
          </div>
        </div>
      </div>
    </div>


    <div class="toolbar tabbar tabbar-labels toolbar-bottom menu">
      <div class="toolbar-inner">
        <a href="/home" class="tab-link tab-link-active">
          <i class="icon material-icons">home</i>
        </a>
        <a href="/schedule" class="tab-link">
          <i class="icon material-icons">today</i>
        </a>
        <a href="#" class="tab-link dynamic-sheet">
        </a>
        <a href="#" class="tab-link">
          <i class="icon material-icons">monetization_on</i>
        </a>
        <a href="#" class="tab-link">
          <i class="icon material-icons">settings</i>
        </a>
      </div>
      <div class="add-circle">
        <img src="/static/images/add_circle_24px_v2.svg" class="dynamic-sheet" alt="">
      </div>
    </div>
    <div class="page-content login-screen-content">
      <div class="list">
        <ul>
          <li>
            <div class="row">
              <div class="col">
                <a href="/intro-splash-01" data-view=".view-main" class="item-link list-button btn-simple">Intro</a>
              </div>
            </div>
          </li>
          <li>
            <div class="row">
              <div class="col">
                <a href="#" data-view=".view-main" class="item-link list-button btn-simple panel-open">Ajustes</a>
              </div>
            </div>
          </li>
          <li>
            <div class="row">
              <div class="col">
                <a href="/" data-view=".view-main" class="item-link list-button btn-simple logout">Salir</a>
              </div>
            </div>
          </li>
        </ul>
      </div>
    </div>
  </div>

</template>
<script>
  import $$ from 'dom7';
  export default {
    on: {
      pageInit: function (e, page) {
        var self = this;
        var app = self.$app;

        app.data.store.getItem('doctor').then(function (value) {
          app.data.doctor = value;
          $$(".navbar .profile").html('<img src="' + app.data.url + '/' + app.data.doctor.photo + '200.png" alt="not found">');
        });

        $$('.logout').click(function (params) {
          app.data.store.clear();
          app.methods.redirectTo('root');
        });

        $$('.panel-open').click(function (e) {
          app.data.store.getItem('doctor').then(function (value) {
            app.data.doctor = value;
            $$(".doctor .name").text(app.data.doctor.name);
            $$(".doctor .mail").text(app.data.doctor.email);
            $$(".panel .avatar").html('<img src="' + app.data.url + '/' + app.data.doctor.photo + '200.png" alt="not found">');
          });
          var panel = app.panel.create({
            el: '.panel',
          });
          panel.open();
          $$(".panel #personal-settings").click(function (e) {
            panel.close();
            app.methods.redirectTo('settings');
          });
        });

        $$('.dynamic-sheet').on('click', function () {
          var dynamicSheet = app.sheet.create({
            content: '<div class="sheet-modal">' +
              '<div class="close-sheet">' +
              '<img src="/static/images/cancel_24px.svg" alt="" class="close">' +
              '</div>' +
              '<div class="sheet-modal-inner">' +
              '<div class="list">' +
              '<ul>' +
              '<li>' +
              '<div class="row">' +
              '<div class="col">' +
              '<a href="#" data-view=".view-main" class="item-link list-button btn-simple consultorios">' +
              '<i class="material-icons">local_hospital</i>' +
              'Consultorios</a>' +
              '</div>' +
              '</div>' +
              '</li>' +
              '<li>' +
              '<div class="row">' +
              '<div class="col">' +
              '<a href="#" data-view=".view-main" class="item-link list-button btn-simple asistentes">' +
              '<i class="material-icons">headset_mic</i>' +
              'Asistentes</a>' +
              '</div>' +
              '</div>' +
              '</li>' +
              '<li>' +
              '<div class="row">' +
              '<div class="col">' +
              '<a href="#" data-view=".view-main" class="item-link list-button btn-simple cita">' +
              '<i class="material-icons">event</i>' +
              'Nueva cita</a>' +
              '</div>' +
              '</div>' +
              '</li>' +
              '<li>' +
              '<div class="row">' +
              '<div class="col">' +
              '<a href="#" data-view=".view-main" class="item-link list-button btn-simple paciente">' +
              '<i class="material-icons">person_add</i>' +
              'Nuevo Paciente</a>' +
              '</div>' +
              '</div>' +
              '</li>' +
              '</ul>' +
              '</div>' +
              '</div>' +
              '</div>',
            on: {
              open: function (sheet) {
                console.log('Sheet open');
              },
              opened: function (sheet) {
                $$('.sheet-modal .close').on('click', function () {
                  dynamicSheet.close();
                });
                $$('.sheet-modal .consultorios').click(function () {
                  dynamicSheet.close();
                  app.methods.redirectTo('offices-show');
                });
                $$('.sheet-modal .asistentes').click(function () {
                  dynamicSheet.close();
                  app.methods.redirectTo('asistentes-invitar-01');
                });
                $$('.sheet-modal .cita').click(function () {
                  dynamicSheet.close();
                  app.methods.redirectTo('agendar-cita');
                });
                $$('.sheet-modal .paciente').click(function () {
                  dynamicSheet.close();
                  app.methods.redirectTo('nuevo-paciente');
                });
              },
            }
          });
          dynamicSheet.open();
        });
      }
    }
  }
</script>